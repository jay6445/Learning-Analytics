#1. variance exercise

  annual_income <- c(62000,64000,49000,324000,1264000,54330,64000,51000,55000,48000,53000)
  #calculate mean
  mean(annual_income) #189848.2
  #calculate the variance
  var(annual_income) #121303099568

#2. covariance exercise

  writing <- c(344,383,611,713,536)
  reading <- c(378,349,503,719,503)
  
  #calculate the covariance between reading and writing scores
  cov(writing,reading) #58.59
  #plot a scatter plot to verify
  plot(reading,writing) #plot can take two vectors
  #ggplot can only take a data frame as an input
  ggplot(data = data.frame(reading,writing),aes(writing,reading))+geom_point(alpha=0.5)

#3. descriptive statistics exercise
  
  #create vector of apartment prices
  prices <- c(117564.0716,147343.694,153466.7124,163162.8792,165430.282,168834.0424,169158.2944,171262.6544,175773.5856,177555.064,179674.0752,188273.7304,188743.1072,189194.3072,190119.504,191389.8688,192092.24,193660.6208,195153.16,195874.944,196142.192,196220.048,197053.5144,197869.364,198075.992,198591.8488,198841.6952,199054.1992,199216.404,199730.734,200148.8944,200300.634,200678.7512,200719.0152,201518.8944,203491.85,204027.0912,204286.6668,204292.494,204434.6784,204808.1604,205085.4048,205098.2108,206445.4232,206631.81,206958.712,207281.5912,207581.4272,208655.6704,208930.812,209280.9104,210038.6992,210745.1664,210824.0576,211406.868,212265.668,212520.826,212644.3948,212916.3568,213942.5624,214341.3364,214631.6804,215410.276,215774.2844,216552.712,216826,217357.6328,217748.48,217786.376,217787.7104,218585.9248,219252.892,219373.4056,219630.9012,219865.7608,220606.28,220865,222138.716,222867.4208,222947.2088,223577.32,223917.336,224076.836,224463.866,225050.52,225290.2204,225401.6152,226342.8032,226578.512,227072.8784,228170.0256,228410.054,228872.912,228937.896,229464.7112,229581.7836,230154.53,230216.2192,230495.0064,230943.3796,231348.928,231552.3256,233142.8,233172.49,233834.0048,234032.884,234172.388,234750.586,235633.2592,235762.34,236608.9528,236639.56,237060.1488,237207.68,237680.8752,238811.064,239248.7512,239341.5808,240539.3476,241620.4832,241671.52,242740.656,243052.5904,244624.872,244820.6672,245572.7936,246050.404,246172.676,246331.904,247739.44,248274.3136,248422.664,248525.1168,249075.6568,249591.9948,250312.5344,250415.382,250773.1452,252053.0264,252185.992,252927.84,253025.7772,253831.0248,255243.1088,255337.898,256376.276,256821.6404,257183.48,258015.6144,258572.4776,261579.892,261742.742,261871.696,263123.4208,263790.8144,264011.698,264142.16,264238.95,264275.7824,265467.68,269075.3016,269278.572,271227.4944,273165.5768,275394.2484,275812.4928,276323.8656,276759.18,278575.8688,279191.256,286433.5728,287466.4116,287996.5296,289727.9904,290031.2588,291494.36,293828.688,293876.2748,294807.648,296483.144,297008.9652,298730.404,299159.1384,300385.6176,306363.6436,306878.4576,308660.8032,310223.2908,310577.0396,310831.2116,310832.5876,312211.144,315382.11,315733.1536,317196.4,317473.8608,322610.7392,322952.5584,323915.8112,326885.336,327044.3684,331154.8784,336695.2524,338181.1808,338472.1328,338482.4544,344530.8888,344568.7428,346048.0408,346906.8932,349865.2224,351304.5776,354553.2324,355073.4032,356506.37,357538.1952,358525.5924,365868.7776,367976.4576,372001.6968,372016.5616,376964.6156,377043.5956,377313.5552,380809.52,382041.128,382277.1488,385447.6872,388515.14,388656.8064,390494.2712,396330.2908,396973.8324,398903.4224,400865.916,401302.8192,401894.818,402081.796,407214.2896,410932.6732,412856.5616,413761.7064,427236.0996,432679.912,448134.2688,448574.6704,452667.0064,456919.456,460001.256,460001.256,461464.992,464549.1904,467083.3132,480545.8096,482404.312,484458.0304,495024.0912,495570.4448,496266.4064,498994.032,503790.2308,506786.664,523373.448,526947.1632,529317.2832,532877.384,538271.7356)
  
  #frequency table for prices
  table(prices)
  
  #histogram
  hist(prices)
  
  #create price intervals of width 100000
  prices ->  sort(prices)
  intervals <- (max(prices)-min(prices))/100000
  intervals #4.207077 #width 100000
  intervals <- 4
  start <- c()
  end <- c()
  start <- min(prices)
  intervals
  
  for(i in 1:5){
  end[i] <- start[i] + 100000  #width
  start[i+1] <- end[i]
  }
  
  start <- head(start,-1) #last element not needed
  end  
  interval_df<-data.frame(interval_start = start,interval_end = end)
  library(dplyr)  
  interval_df <-  interval_df %>% mutate(frequency=1)   
  interval_df  
  str(interval_df)  
  
  for(i in 1:length(interval_df$frequency)){
  interval_df$frequency[i] <- 0
    for(j in 1:length(prices))
    {
      ifelse(prices[j]>=start[i] & prices[j]<=end[i], interval_df$frequency[i] <- interval_df$frequency[i]+1, interval_df$frequency[i] <- interval_df$frequency[i] + 0)
    }
    
  }
  
  interval_df
  length(prices)    
  #after dividing the data frame into intervals we plot it again in histogram
  hist(prices)
  hist(interval_df$frequency)
  
  #relation between area and prices
  
  area <- c(410.71,579.75,587.28,587.28,598.58,606.33,618.16,618.16,618.16,618.38,618.38,618.38,625.80,625.80,625.80,625.80,649.69,649.69,649.80,649.80,649.80,649.80,649.80,669.16,670.24,670.89,670.89,670.89,675.19,675.19,680.57,697.89,697.89,701.66,701.66,713.71,717.05,720.38,720.38,720.70,720.70,720.81,720.81,720.81,722.96,723.83,723.83,723.83,723.93,723.93,733.19,733.19,733.19,733.19,733.19,733.19,736.63,743.09,743.09,743.09,743.09,743.41,743.41,747.50,747.50,756.21,756.21,756.21,756.21,756.21,758.69,763.21,775.69,775.69,781.07,781.07,781.07,781.07,781.07,781.07,781.07,781.07,781.07,781.07,781.07,781.07,781.07,781.07,782.25,782.25,782.25,782.25,782.25,782.25,782.25,782.25,784.19,785.48,785.48,785.48,785.48,785.48,785.48,785.48,785.48,785.48,785.48,785.48,785.48,785.48,789.25,789.25,789.25,789.25,789.25,789.25,789.25,790.54,791.72,794.52,794.52,794.52,794.52,794.52,794.52,794.52,794.52,794.52,794.52,794.52,794.52,794.52,794.52,798.28,798.28,798.28,798.28,798.28,798.28,798.28,798.28,798.28,798.28,798.28,798.28,798.28,798.28,798.50,798.50,798.50,798.50,798.50,798.50,798.50,798.50,798.50,798.50,800.96,827.87,827.87,827.87,827.87,827.87,923.21,923.21,923.21,923.21,923.21,923.21,923.21,923.21,927.08,927.08,927.83,927.83,927.83,927.83,928.16,957.53,966.57,977.87,1013.27,1057.92,1057.92,1057.92,1057.92,1057.92,1058.25,1058.25,1058.25,1068.58,1074.71,1093.00,1109.25,1109.25,1109.25,1109.25,1110.32,1111.72,1121.95,1121.95,1121.95,1121.95,1121.95,1121.95,1127.76,1127.76,1128.40,1132.06,1132.06,1137.44,1160.36,1160.36,1160.36,1160.36,1160.36,1171.55,1200.82,1203.29,1222.34,1238.58,1238.58,1238.58,1273.55,1273.55,1273.55,1273.55,1273.55,1273.88,1273.88,1273.88,1283.45,1288.62,1305.62,1307.45,1325.31,1336.93,1343.39,1357.16,1375.45,1383.84,1396.86,1400.95,1434.09,1434.09,1434.09,1434.09,1479.72,1479.72,1596.35,1596.35,1596.35,1596.35,1596.35,1603.99,1604.75,1604.75,1604.75,1608.84,1611.85,1611.85,1611.85,1611.85,1615.29,1615.29,1769.48,1942.50)
  area
  house <- data.frame(prices = prices, area = area)

  plot(prices,area)
  #positive correlation between area and prices (note : this does not show causality)
  
#4 Calculate the mean, median, mode, skewness, variance and standard deviation of Price for all apartments, no matter if sold or not.
  
  #mean
  mean(prices) #281171.9
  
  #median
  position <- (length(prices)+1)/2
  position #134
  median <- prices[134]
  median #249075.7
  
  #mode
  getmode <- function(v) {
    uniqv <- unique(v)
    uniqv[which.max(tabulate(match(v, uniqv)))]
  }
  
  getmode(prices) #460001.3
  
  #mode > mean therefore we get a left skew
  
#5 Calculate the covariance and correlation coefficient between Price and Area, no matter if the apartment is sold or not. Is the result in line with the scatter plot?
  
  cov(prices,area) #25181356
  
  cor.test(prices,area) #0.9917989 very high coefficient
  